<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Black-Tappy Code Obfuscation</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/javascript-obfuscator/dist/index.browser.js"></script>
  <style>
    /* Basic Reset & Body Styling */
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;

      /* Dynamic Background Styling */
      background: linear-gradient(270deg, #ff9a9e, #fad0c4, #a1c4fd, #c2e9fb, #a1c4fd, #fad0c4, #ff9a9e);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
    }

    @keyframes gradientShift {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    /* Header Styling */
    .header-gradient {
      width: 100%;
      max-width: 900px;
      background: linear-gradient(45deg, #6a11cb 0%, #2575fc 100%);
      padding: 20px 0;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      margin-bottom: 30px;
      text-align: center;
    }

    .main-title {
      color: #fff;
      font-size: 2.5em;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Main Content Area */
    main {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
      width: 100%;
      max-width: 1200px; /* Increased max-width for better layout */
    }

    .box {
      background-color: #fff;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      padding: 30px;
      flex: 1;
      min-width: 300px;
      max-width: 550px; /* Adjusted max-width for boxes */
      display: flex;
      flex-direction: column;
    }

    .section-title {
      font-size: 1.8em;
      color: #444;
      margin-top: 0;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title .icon {
      font-size: 1.2em;
      color: #2575fc;
    }

    .code-area {
      width: calc(100% - 20px); /* Adjust width for padding */
      height: 250px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.95em;
      resize: vertical;
      margin-bottom: 20px;
      background-color: #f9f9f9;
      color: #333;
      line-height: 1.5;
    }

    .code-area.readonly {
      background-color: #e9e9e9;
      cursor: not-allowed;
    }

    /* Slider and Obfuscation Level */
    .slider-row {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }

    .security-label {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 1.1em;
      font-weight: bold;
      color: #555;
    }

    .level-badge {
      background-color: #2575fc;
      color: #fff;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.9em;
    }

    #securitySlider {
      width: 80%;
      -webkit-appearance: none;
      height: 8px;
      background: #ddd;
      outline: none;
      border-radius: 5px;
      opacity: 0.7;
      transition: opacity .2s;
    }

    #securitySlider:hover {
      opacity: 1;
    }

    #securitySlider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2575fc;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    #securitySlider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2575fc;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .level-desc {
      display: flex;
      justify-content: space-between;
      width: 80%;
      margin-top: 10px;
      font-size: 0.9em;
      color: #777;
      align-items: center;
    }

    .level-desc .dot {
      width: 8px;
      height: 8px;
      background-color: #ccc;
      border-radius: 50%;
      display: inline-block;
      margin: 0 5px;
    }

    .level-desc .dot.active {
      background-color: #2575fc;
    }

    /* Buttons */
    .js-btn {
      background-color: #2575fc;
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1.1em;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      margin-top: 20px;
      width: 100%;
    }

    .js-btn:hover {
      background-color: #1a5ac7;
      transform: translateY(-2px);
    }

    .output-btn-row {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      justify-content: flex-end;
    }

    .secondary-btn {
      background-color: #6c757d;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.95em;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .secondary-btn:hover {
      background-color: #5a6268;
      transform: translateY(-2px);
    }

    /* Footer */
    footer {
      width: 100%;
      max-width: 900px;
      text-align: center;
      padding: 20px 0;
      margin-top: 30px;
      color: #555;
      font-size: 0.9em;
    }

    .footer-links {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 15px;
    }

    .footer-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #2575fc;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }

    .footer-btn:hover {
      color: #1a5ac7;
    }

    .footer-icon {
      width: 24px;
      height: 24px;
    }

    .copyright {
      margin: 0;
      color: #777;
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .main-title {
        font-size: 2em;
      }

      main {
        flex-direction: column;
        align-items: center;
      }

      .box {
        width: 90%;
        max-width: 500px; /* Constrain max-width on smaller screens */
      }

      .output-btn-row {
        flex-direction: column;
        gap: 10px;
      }

      .secondary-btn {
        width: 100%;
      }

      .level-desc {
        width: 90%;
      }
    }

    @media (max-width: 480px) {
      .main-title {
        font-size: 1.8em;
      }

      .box {
        padding: 20px;
      }

      .section-title {
        font-size: 1.5em;
      }

      .js-btn, .secondary-btn {
        padding: 10px 15px;
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
<audio id="myAudio" loop muted>
  <source src="https://files.catbox.moe/zm0dew.mp3" type="audio/mp3">
</audio>
  <div class="header-gradient">
    <h1 class="main-title">Black-Tappy Code Obfuscation</h1>
  </div>
  <main>
    <section class="box">
      <h2 class="section-title"><span class="icon">ðŸ’»</span> Input JavaScript Code</h2>
      <textarea id="inputCode" class="code-area" placeholder="Enter your JavaScript code here..."></textarea>

      <div class="slider-row">
        <div class="security-label">
          <span>Security Level</span>
          <span id="levelValue" class="level-badge">MEDIUM</span>
        </div>
        <input type="range" id="securitySlider" min="1" max="3" value="2" />
      </div>
      <div class="level-desc">
        <span class="dot active"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span>Basic</span>
        <span style="flex:1"></span>
        <span>Medium</span> <!-- Changed from Standard to Medium -->
        <span style="flex:1"></span>
        <span>Advanced</span>
      </div>
      <button id="obfuscateBtn" class="js-btn">JS Obfuscator</button>
    </section>

    <section class="box">
      <h2 class="section-title"><span class="icon">ðŸ”’</span> Here Is Your Protected Code</h2>
      <div class="output-btn-row">
        <button id="copyBtn" class="secondary-btn">Copy Code</button>
        <button id="downloadBtn" class="secondary-btn">Download File</button>
      </div>
      <textarea id="outputCode" class="code-area readonly" readonly placeholder="Your protected JavaScript code will appear here..."></textarea>
    </section>
  </main>
  <footer>
    <div class="footer-links">
      <a href="https://github.com/Black-Tappy/XEON-XMD" class="footer-btn" target="_blank" rel="noopener">
        <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" alt="GitHub icon" class="footer-icon"/>
        GitHub
      </a>
      <a href="https://whatsapp.com/channel/0029VasHgfG4tRrwjAUyTs10" class="footer-btn" target="_blank" rel="noopener">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp icon" class="footer-icon"/>
        WhatsApp Channel
      </a>
    </div>
    <p class="copyright">
      Â© 2025 I Black-Tappy Obfuscation. All rights reserved.
    </p>
  </footer>
  <script>
    // Self-defending mechanism to detect tampering, common in obfuscated code.
    const oneTimeFunctionExecutor = function () {
      let isFirstCall = true; // Flag to ensure the inner function is executed only once.

      // This returned function will be called with a context (this) and a function to execute.
      return function (context, funcToExecute) {
        // The executorFunction is defined based on whether it's the first call.
        const executorFunction = isFirstCall ? function () {
          // If funcToExecute exists (i.e., not nullified yet)
          if (funcToExecute) {
            // Apply the funcToExecute with the given context and arguments.
            const result = funcToExecute.apply(context, arguments);
            funcToExecute = null; // Nullify the function to prevent re-execution.
            return result; // Return the result of the executed function.
          }
        } : function () {}; // After the first call, it becomes a no-op function.

        isFirstCall = false; // Set the flag to false after the first call.
        return executorFunction; // Return the actual function that will perform the execution.
      };
    }();

    // selfDefendingCheck is assigned the result of calling oneTimeFunctionExecutor.
    // The function passed to it contains a 'catastrophic backtracking' regex.
    // This is a common technique used by obfuscators to detect if the code's toString()
    // representation has been altered, which often happens during deobfuscation attempts.
    const selfDefendingCheck = oneTimeFunctionExecutor(this, function () {
      // This line attempts to trigger a catastrophic backtracking regex if the toString()
      // method of functions has been modified, which is a sign of tampering.
      // The specific regex "(((.+)+)+)+$" is known for this behavior.
      return selfDefendingCheck.toString().search("(((.+)+)+)+$").toString().constructor(selfDefendingCheck).search("(((.+)+)+)+$");
    });

    // Execute the self-defending check. If tampering is detected, this might cause
    // a runtime error or unexpected behavior, preventing further execution or analysis.
    selfDefendingCheck();

    // Get references to the HTML elements
    const securitySlider = document.getElementById("securitySlider");
    const levelValue = document.getElementById("levelValue");
    const inputCode = document.getElementById("inputCode");
    const outputCode = document.getElementById("outputCode");
    const obfuscateBtn = document.getElementById("obfuscateBtn");
    const copyBtn = document.getElementById("copyBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const dots = document.querySelectorAll(".level-desc .dot"); // Corrected selector for dots

    // Define basic obfuscation options
    const basicObfuscationOptions = {
      compact: true,
      controlFlowFlattening: false, // Disabled for basic
      deadCodeInjection: false, // Disabled for basic
      stringArray: false, // Disabled for basic
      numbersToExpressions: false // Disabled for basic
    };

    // Configuration for the BASIC obfuscation level
    const basicLevelConfig = {
      label: "BASIC",
      options: basicObfuscationOptions
    };

    // Define medium obfuscation options
    const mediumObfuscationOptions = {
      compact: true,
      controlFlowFlattening: true, // Enabled for medium
      controlFlowFlatteningThreshold: 0.5, // 50% of control flow will be flattened
      deadCodeInjection: true, // Enabled for medium
      deadCodeInjectionThreshold: 0.2, // 20% of dead code will be injected
      stringArray: true, // Enabled for medium
      stringArrayThreshold: 0.7, // 70% of strings will be moved to string array
      numbersToExpressions: true, // Enabled for medium
      splitStrings: false // Disabled for medium
    };

    // Configuration for the MEDIUM obfuscation level
    const mediumLevelConfig = {
      label: "MEDIUM",
      options: mediumObfuscationOptions
    };

    // Define advanced obfuscation options
    const advancedObfuscationOptions = {
      compact: true,
      controlFlowFlattening: true, // Enabled for advanced
      controlFlowFlatteningThreshold: 0x1, // 100% of control flow will be flattened
      deadCodeInjection: true, // Enabled for advanced
      deadCodeInjectionThreshold: 0x1, // 100% of dead code will be injected
      stringArray: true, // Enabled for advanced
      stringArrayThreshold: 0x1, // 100% of strings will be moved to string array
      splitStrings: true, // Enabled for advanced
      splitStringsChunkLength: 0x4, // Strings split into chunks of 4 characters
      numbersToExpressions: true, // Enabled for advanced
      simplify: true, // Enabled for advanced (simplifies expressions)
      rotateStringArray: true, // Enabled for advanced (rotates string array)
      selfDefending: true, // Enabled for advanced (adds anti-tampering)
      transformObjectKeys: true // Enabled for advanced (transforms object keys)
    };

    // Configuration for the ADVANCED obfuscation level
    const advancedLevelConfig = {
      label: "ADVANCED",
      options: advancedObfuscationOptions
    };

    // Map slider values (1, 2, 3) to their respective obfuscation configurations
    const obfuscationLevelsMap = {
      '1': basicLevelConfig,
      '2': mediumLevelConfig,
      '3': advancedLevelConfig
    };

    // Function to update security level display and dots
    const updateSecurityLevelDisplay = () => {
      const sliderValueInt = parseInt(securitySlider.value, 10);
      levelValue.textContent = obfuscationLevelsMap[sliderValueInt].label;

      dots.forEach((dotElement, dotIndex) => {
        dotElement.classList.toggle("active", dotIndex === sliderValueInt - 1);
      });
    };

    // Initial update of the security level display
    updateSecurityLevelDisplay();

    // Event listener for the security slider input
    securitySlider.addEventListener("input", updateSecurityLevelDisplay);

    // Event listener for the Obfuscate button click
    obfuscateBtn.addEventListener("click", () => {
      const inputCodeValue = inputCode.value; // Get the code from the input textarea

      // If input code is empty or just whitespace, display a message
      if (!inputCodeValue.trim()) {
        outputCode.value = "// Tafadhali andika JavaScript code kwanza (Black-Tappy)"; // Message in Swahili
        return;
      }

      try {
        // Get the selected obfuscation options based on the slider value
        const selectedOptions = obfuscationLevelsMap[securitySlider.value].options;

        // Obfuscate the code using the JavaScriptObfuscator library
        // window.JavaScriptObfuscator is expected to be globally available (loaded from a script tag)
        const obfuscatedCodeResult = window.JavaScriptObfuscator.obfuscate(inputCodeValue, selectedOptions);

        // Display the obfuscated code in the output textarea
        outputCode.value = "// Obfuscated by Black-Tappy [" + obfuscationLevelsMap[securitySlider.value].label + "]\n" + obfuscatedCodeResult.getObfuscatedCode();
      } catch (error) {
        // If an error occurs during obfuscation, display the error message
        outputCode.value = "// Error: " + error.message;
        console.error("Obfuscation error:", error);
      }
    });

    // Event listener for the Copy button click
    copyBtn.addEventListener("click", () => {
      if (outputCode.value) {
        outputCode.select(); // Select all text in the output textarea
        document.execCommand("copy"); // Copy the selected text to clipboard
        alert('Code copied to clipboard!');
      } else {
        alert('No code to copy!');
      }
    });

    // Event listener for the Download button click
    downloadBtn.addEventListener("click", () => {
      if (outputCode.value) {
        const filename = 'obfuscated_code.js';
        const blobOptions = {
          type: "text/javascript"
        }; // Define blob type as JavaScript

        // Create a Blob containing the obfuscated code
        const codeBlob = new Blob([outputCode.value], blobOptions);
        const url = URL.createObjectURL(codeBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      } else {
        alert('No code to download!');
      }
    });

    // Audio autoplay workaround: Play audio only after user interaction
    document.addEventListener('click', function () {
      const audio = document.getElementById('myAudio');
      audio.muted = false;
      audio.play();
    }, { once: true });
  </script>
</body>
</html>
